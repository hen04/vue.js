<!doctype html>
<html lang="ru">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
	<title>Users List</title>
</head>
<body>

	<style>
		.wrapper {
			max-width: 800px;
			margin: 0 auto;
		}
		[v-cloak] {
			display: none;
		}
	</style>

	<div
		v-cloak
		id="users"
		class="wrapper">

		<h3>Список пользователей</h3>

		<users-list v-bind:users="list"></users-list>

		<strong>Всего пользователей: {{ total }}</strong>

	</div>

	<template id="table">
		<div v-if="tableShow">

			<div
					v-for="item in users"
					class="row align-items-center m-2">

				<div
						class="col-1 p-0">

					<img
							v-if="item.image !== ''"
							v-bind:src="item.image" alt="">

					<img
							v-else src="images/noimage.jpg" alt="">

				</div>

				<div
						class="col-11">
					{{ item.name }}
				</div>

			</div>

		</div>
	</template>

	<script src="https://cdn.jsdelivr.net/npm/vue@2.6.10/dist/vue.js"></script>
	<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
	<script>

		var UsersList = {
			template: '#table',
			props: {
				users: {
					type: Array
				}
			},
			data: function () {
				return {
					tableShow: true,
				}
			}
		};

		// ======================

		window.vm = new Vue({
			el: '#users',
			components: {
				'users-list': UsersList
			},
			data: function () {
				return {
					list: [],
				}
			},
			created: function() {
				this.loadData();
			},
			watch: {
				toggleTableShow: function() {
					this.tableShow = !this.tableShow
				}
			},
			computed: {
				tableShowButton: function() {
					return this.tableShow ? 'Скрыть пользователей' : 'Показать пользователей'
				},
				total: function () {
					return this.list.length;
				}
			},
			methods: {
				toggleTableShow: function() {
					this.tableShow = !this.tableShow
				},
				loadData: function () {
					var self = this;

					axios.get('https://hen04.github.io/vue.js/users-list.json')
						.then (function (response) {
							console.log(('Данные загружены'));
							self.list = response.data
						})
				}
			}

		});
	</script>
</body>
</html>